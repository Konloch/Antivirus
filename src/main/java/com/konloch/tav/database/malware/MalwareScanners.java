package com.konloch.tav.database.malware;

import com.konloch.tav.database.malware.signature.StaticLengthSignatureScanner;
import com.konloch.tav.database.malware.signature.VariableLengthSignatureScanner;
import com.konloch.tav.database.malware.yara.YaraScanner;
import com.konloch.tav.scanning.MalwareScanFile;

/**
 * @author Konloch
 * @since 6/21/2024
 */
public class MalwareScanners
{
	public final StaticLengthSignatureScanner staticLengthSignatureScanner = new StaticLengthSignatureScanner();
	public final VariableLengthSignatureScanner detectedVariableLengthFileSignatureDatabase = new VariableLengthSignatureScanner();
	public final YaraScanner yaraScanner = new YaraScanner();
	
	public String detectAsMalware(MalwareScanFile file)
	{
		String result;
		if((result = staticLengthSignatureScanner.detectAsMalware(file)) != null)
			return result;
		
		if((result = detectedVariableLengthFileSignatureDatabase.detectAsMalware(file)) != null)
			return result;
		
		if((result = yaraScanner.detectAsMalware(file)) != null)
			return result;
		
		return null;
	}
}
