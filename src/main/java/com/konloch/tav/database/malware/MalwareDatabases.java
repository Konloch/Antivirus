package com.konloch.tav.database.malware;

import com.konloch.TraditionalAntivirus;
import com.konloch.tav.database.malware.signature.StaticLengthSignatureScanner;
import com.konloch.tav.database.malware.signature.VariableLengthSignatureScanner;
import com.konloch.tav.scanning.MalwareScanFile;

import java.text.NumberFormat;

/**
 * @author Konloch
 * @since 6/21/2024
 */
public class MalwareDatabases
{
	public final StaticLengthSignatureScanner staticLengthSignatureScanner = new StaticLengthSignatureScanner();
	public final VariableLengthSignatureScanner detectedVariableLengthFileSignatureDatabase = new VariableLengthSignatureScanner();
	//TODO add the rest of the databases / implement their scanning methods
	
	public void printDatabaseStatistics()
	{
		System.out.println("Counted " + NumberFormat.getInstance().format(TraditionalAntivirus.TAV.sqLiteDB.countFileSignatures()) + " malware signatures in the SQLite db");
	}
	
	public String detectAsMalware(MalwareScanFile file)
	{
		String result;
		if((result = staticLengthSignatureScanner.detectAsMalware(file)) != null)
			return result;
		
		if((result = detectedVariableLengthFileSignatureDatabase.detectAsMalware(file)) != null)
			return result;
		
		return null;
	}
}
