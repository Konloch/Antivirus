package com.konloch.tav.database.malware;

import com.konloch.tav.database.malware.signature.DetectedStaticLengthFileSignatureDatabase;
import com.konloch.tav.database.malware.signature.DetectedVariableLengthFileSignatureDatabase;
import com.konloch.tav.scanning.MalwareScanFile;

import java.text.NumberFormat;

/**
 * @author Konloch
 * @since 6/21/2024
 */
public class MalwareDatabases
{
	public final DetectedStaticLengthFileSignatureDatabase detectedStaticLengthFileSignatureDatabase = new DetectedStaticLengthFileSignatureDatabase();
	public final DetectedVariableLengthFileSignatureDatabase detectedVariableLengthFileSignatureDatabase = new DetectedVariableLengthFileSignatureDatabase();
	//TODO add the rest of the databases / implement their scanning methods
	
	public void loadAllDatabases()
	{
		detectedStaticLengthFileSignatureDatabase.load();
		detectedVariableLengthFileSignatureDatabase.load();
		
		
		System.out.println("Loaded " + NumberFormat.getInstance().format(detectedStaticLengthFileSignatureDatabase.totalCount) + " malware signatures into memory");
	}
	
	public String detectAsMalware(MalwareScanFile file)
	{
		String result;
		if((result = detectedStaticLengthFileSignatureDatabase.detectAsMalware(file)) != null)
			return result;
		
		if((result = detectedVariableLengthFileSignatureDatabase.detectAsMalware(file)) != null)
			return result;
		
		return null;
	}
}
