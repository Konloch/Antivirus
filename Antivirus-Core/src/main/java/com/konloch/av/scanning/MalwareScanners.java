package com.konloch.av.scanning;

import com.konloch.av.database.malware.MalwareScanFile;
import com.konloch.av.scanning.signature.StaticLengthSignatureScanner;
import com.konloch.av.scanning.signature.VariableLengthSignatureScanner;
import com.konloch.av.scanning.yara.YaraScanner;

/**
 * @author Konloch
 * @since 6/21/2024
 */
public class MalwareScanners
{
	private final MalwareScanner[] scanners = new MalwareScanner[]
	{
			new StaticLengthSignatureScanner(),
			new VariableLengthSignatureScanner(),
			new YaraScanner(),
	};
	
	public String detectAsMalware(MalwareScanFile file)
	{
		String result;
		for(MalwareScanner scanner : scanners)
		{
			try
			{
				if ((result = scanner.detectAsMalware(file)) != null)
					return result;
			}
			catch (Exception e)
			{
				e.printStackTrace(); //log and solve at a later date
			}
		}
		
		return null;
	}
}
